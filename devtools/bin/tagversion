#!/bin/bash
# $Id$
if [ "$1" == "-h" -o "$1" == "--help" ]; then
    echo "tagversion, tag version in cvs"
    echo "options:"
    echo "  -n: don't tag, just echo tag name"
    echo "  -h, --help: this help"
    exit
fi

p=`cat RPMNAME`
b=`cvs status VERSION | grep 'SuSE-.*-Branch' | sed 's/^.*SuSE-\(.*\)-Branch.*$/\1/'`
v=`cat VERSION | tr "." "_"`
if [ -z "$p" -o -z "$v" ]; then
    echo "Cannot find RPMNAME or VERSION in `pwd`"
    exit 1
fi
if [ "$b" ]; then
  t=branch-$b-$v
else
  t=stable-$v
fi
if [ "$1" == "-n" ]; then
  echo "$t"
else
  echo "$p $t"
  cvs tag $t
fi
